"use strict";
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
const availableSources = __importStar(require("../sources"));
const react_document_renderer_1 = require("@ohoareau/react-document-renderer");
async function generatePdf(ctx) {
    const sources = { ...availableSources, ...(ctx.config.sources || {}) };
    const source = sources[ctx.query.source || 'default'];
    if (!source)
        return ctx.helpers.httpNotFound();
    const sourced = (await source(ctx)) || {};
    if (!sourced || !sourced.definition)
        return ctx.helpers.httpNotFound();
    return ctx.helpers.buffer({ contentType: 'application/pdf', ...sourced, buffer: await react_document_renderer_1.render(sourced.definition) });
}
exports.generatePdf = generatePdf;
exports.default = generatePdf;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVQZGYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYWN0aW9ucy9nZW5lcmF0ZVBkZi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDQSw2REFBK0M7QUFDL0MsK0VBQXlEO0FBRWxELEtBQUssVUFBVSxXQUFXLENBQUMsR0FBUTtJQUN0QyxNQUFNLE9BQU8sR0FBRyxFQUFDLEdBQUcsZ0JBQWdCLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQyxFQUFDLENBQUM7SUFDckUsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsTUFBTSxJQUFJLFNBQVMsQ0FBQyxDQUFDO0lBQ3RELElBQUksQ0FBQyxNQUFNO1FBQUUsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQy9DLE1BQU0sT0FBTyxHQUFHLENBQUMsTUFBTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDMUMsSUFBSSxDQUFDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVO1FBQUUsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3ZFLE9BQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBQyxXQUFXLEVBQUUsaUJBQWlCLEVBQUUsR0FBRyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZ0NBQU0sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUMsQ0FBQyxDQUFDO0FBQ3RILENBQUM7QUFQRCxrQ0FPQztBQUVELGtCQUFlLFdBQVcsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Y3R4LCBodHRwX3Jlc3BvbnNlfSBmcm9tIFwiQG9ob2FyZWF1L2xhbWJkYS11dGlsc1wiO1xuaW1wb3J0ICogYXMgYXZhaWxhYmxlU291cmNlcyBmcm9tIFwiLi4vc291cmNlc1wiO1xuaW1wb3J0IHtyZW5kZXJ9IGZyb20gJ0BvaG9hcmVhdS9yZWFjdC1kb2N1bWVudC1yZW5kZXJlcic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVBkZihjdHg6IGN0eCk6IFByb21pc2U8aHR0cF9yZXNwb25zZT4ge1xuICAgIGNvbnN0IHNvdXJjZXMgPSB7Li4uYXZhaWxhYmxlU291cmNlcywgLi4uKGN0eC5jb25maWcuc291cmNlcyB8fCB7fSl9O1xuICAgIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXNbY3R4LnF1ZXJ5LnNvdXJjZSB8fCAnZGVmYXVsdCddO1xuICAgIGlmICghc291cmNlKSByZXR1cm4gY3R4LmhlbHBlcnMuaHR0cE5vdEZvdW5kKCk7XG4gICAgY29uc3Qgc291cmNlZCA9IChhd2FpdCBzb3VyY2UoY3R4KSkgfHwge307XG4gICAgaWYgKCFzb3VyY2VkIHx8ICFzb3VyY2VkLmRlZmluaXRpb24pIHJldHVybiBjdHguaGVscGVycy5odHRwTm90Rm91bmQoKTtcbiAgICByZXR1cm4gY3R4LmhlbHBlcnMuYnVmZmVyKHtjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3BkZicsIC4uLnNvdXJjZWQsIGJ1ZmZlcjogYXdhaXQgcmVuZGVyKHNvdXJjZWQuZGVmaW5pdGlvbil9KTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZ2VuZXJhdGVQZGYiXX0=