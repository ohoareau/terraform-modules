"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const lambda_utils_1 = require("@ohoareau/lambda-utils");
const webhook_1 = __importDefault(require("./services/webhook"));
const order_1 = __importDefault(require("./services/order"));
function default_1() {
    return lambda_utils_1.createRouterHandler(async function ({ resourcePath, path, config, responses }, event, context) {
        let result = undefined;
        const query = {
            event, config, context,
        };
        switch (resourcePath) {
            case 'POST /webhooks':
                result = await webhook_1.default.process(query);
                break;
            case 'POST /orders':
                result = await order_1.default.create(query);
                break;
            case 'GET /orders/:id':
                result = await order_1.default.get(query);
                break;
            case 'GET /':
                result = { statusCode: 200, body: {} };
                break;
            default: throw new Error(`Not Found`);
        }
        return responses.http(await result);
    });
}
exports.default = default_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSx5REFBMEU7QUFDMUUsaUVBQWdEO0FBQ2hELDZEQUE0QztBQUU1QztJQUtJLE9BQU8sa0NBQW1CLENBS3RCLEtBQUssV0FBVyxFQUFDLFlBQVksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBQyxFQUFFLEtBQUssRUFBRSxPQUFPO1FBTW5FLElBQUksTUFBTSxHQUE0QixTQUFTLENBQUM7UUFFaEQsTUFBTSxLQUFLLEdBQUc7WUFFVixLQUFLLEVBQUUsTUFBTSxFQUFFLE9BQU87U0FDekIsQ0FBQztRQUVGLFFBQVEsWUFBWSxFQUFFO1lBQ2xCLEtBQUssZ0JBQWdCO2dCQUFFLE1BQU0sR0FBRyxNQUFNLGlCQUFjLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUFDLE1BQU07WUFDM0UsS0FBSyxjQUFjO2dCQUFFLE1BQU0sR0FBRyxNQUFNLGVBQVksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQUMsTUFBTTtZQUN0RSxLQUFLLGlCQUFpQjtnQkFBRSxNQUFNLEdBQUcsTUFBTSxlQUFZLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUFDLE1BQU07WUFDdEUsS0FBSyxPQUFPO2dCQUFFLE1BQU0sR0FBRyxFQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBQyxDQUFDO2dCQUFDLE1BQU07WUFDMUQsT0FBTyxDQUFDLENBQUMsTUFBTSxJQUFJLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUN6QztRQUVELE9BQU8sU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLE1BQU0sQ0FBQyxDQUFDO0lBRXhDLENBQUMsQ0FDSixDQUFDO0FBRU4sQ0FBQztBQXBDRCw0QkFvQ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2NyZWF0ZVJvdXRlckhhbmRsZXIsIGh0dHBfcmVzcG9uc2V9IGZyb20gXCJAb2hvYXJlYXUvbGFtYmRhLXV0aWxzXCI7XG5pbXBvcnQgd2ViaG9va1NlcnZpY2UgZnJvbSAnLi9zZXJ2aWNlcy93ZWJob29rJztcbmltcG9ydCBvcmRlclNlcnZpY2UgZnJvbSAnLi9zZXJ2aWNlcy9vcmRlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCkge1xuXG4gICAgLy8gdGhpcyBsYW1iZGEgaGFuZGxlciB3aWxsIGhhbmRsZSBjb21wbGV0ZWx5IHRoZSBodHRwIGV2ZW50IGNvbWluZyBmcm9tIGFuIEFQSSBHYXRld2F5IGFwaVxuICAgIC8vIGZlYXR1cmVzIGFyZSAobm90IGV4aGF1c3RpdmUpOiByZXNpemluZyBvZiBzb3VyY2UgaW1hZ2VzLCBmbGlwcGluZywgY29udmVyc2lvbiAoc3ZnID0+IHBuZywgLi4uKVxuXG4gICAgcmV0dXJuIGNyZWF0ZVJvdXRlckhhbmRsZXIoXG5cbiAgICAgICAgLy8gdGhpcyBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBvbmx5IGlmIHRoZSByZXF1ZXN0ZWQgcmVzb3VyY2UgaXMgbm90IGZhdmljb24vcm9ib3RzLnR4dC8uLi5cbiAgICAgICAgLy8gdGhpcyBpcyB0aGUgaGVhcnQgb2YgdGhlIG1pY3Jvc2VydmljZSwgdGhlIGN1c3RvbSBwYXJ0LlxuXG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uICh7cmVzb3VyY2VQYXRoLCBwYXRoLCBjb25maWcsIHJlc3BvbnNlc30sIGV2ZW50LCBjb250ZXh0KSB7XG5cbiAgICAgICAgICAgIC8vIHRoZSBgZXZlbnRgIGNvbnRhaW5zIHRoZSBBUEkgR2F0ZXdheSByYXcgZXZlbnRcbiAgICAgICAgICAgIC8vIHRoZSBgY29uZmlnYCBvYmplY3QgaXMgY29taW5nIGZyb20gdGhlIGNvbmZpZ3VyYXRpb24gZmlsZSAoY29uZmlnLmpzKVxuICAgICAgICAgICAgLy8gdGhlIGByZXNwb25zZXNgIHZhcmlhYmxlIGNvbnRhaW5zIGhlbHBlcnMgZm9yIHNlbmRpbmcgY29tbW9uIHJlc3BvbnNlcyAocmVkaXJlY3QsIG5vdGZvdW5kLCAuLi4pXG5cbiAgICAgICAgICAgIGxldCByZXN1bHQ6IGh0dHBfcmVzcG9uc2V8dW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgICAgICAgICAgICAvLyBAdG9kbyBhZGQgYGRhdGFgIGZyb20gcG9zdGVkIGRhdGEsIGFuZCBgaWRgIChhbmQgb3RoZXJzKSBmcm9tIHJvdXRlLXBhcmFtc1xuICAgICAgICAgICAgICAgIGV2ZW50LCBjb25maWcsIGNvbnRleHQsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHJlc291cmNlUGF0aCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ1BPU1QgL3dlYmhvb2tzJzogcmVzdWx0ID0gYXdhaXQgd2ViaG9va1NlcnZpY2UucHJvY2VzcyhxdWVyeSk7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1BPU1QgL29yZGVycyc6IHJlc3VsdCA9IGF3YWl0IG9yZGVyU2VydmljZS5jcmVhdGUocXVlcnkpOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdHRVQgL29yZGVycy86aWQnOiByZXN1bHQgPSBhd2FpdCBvcmRlclNlcnZpY2UuZ2V0KHF1ZXJ5KTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnR0VUIC8nOiByZXN1bHQgPSB7c3RhdHVzQ29kZTogMjAwLCBib2R5OiB7fX07IGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRocm93IG5ldyBFcnJvcihgTm90IEZvdW5kYCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZXMuaHR0cChhd2FpdCByZXN1bHQpO1xuXG4gICAgICAgIH1cbiAgICApO1xuXG59Il19