"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const lambda_utils_1 = require("@ohoareau/lambda-utils");
const imageman_1 = __importDefault(require("@ohoareau/imageman"));
const parseEvent_1 = __importDefault(require("./utils/parseEvent"));
function default_1() {
    return lambda_utils_1.createRouterHandler(async function ({ config, responses }, event, context) {
        const { options, ...order } = await parseEvent_1.default(event, context, config);
        const buffer = await imageman_1.default(order);
        return responses.buffer({ buffer, ...options });
    });
}
exports.default = default_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSx5REFBMkQ7QUFDM0Qsa0VBQTJEO0FBQzNELG9FQUE0QztBQUU1QztJQUtJLE9BQU8sa0NBQW1CLENBS3RCLEtBQUssV0FBVyxFQUFDLE1BQU0sRUFBRSxTQUFTLEVBQUMsRUFBRSxLQUFLLEVBQUUsT0FBTztRQVEvQyxNQUFNLEVBQUMsT0FBTyxFQUFFLEdBQUcsS0FBSyxFQUFDLEdBQUcsTUFBTSxvQkFBVSxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFLckUsTUFBTSxNQUFNLEdBQUcsTUFBTSxrQkFBUSxDQUFDLEtBQXNCLENBQUMsQ0FBQztRQUl0RCxPQUFPLFNBQVMsQ0FBQyxNQUFNLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxPQUFPLEVBQUMsQ0FBQyxDQUFDO0lBRWxELENBQUMsQ0FDSixDQUFDO0FBRU4sQ0FBQztBQWhDRCw0QkFnQ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2NyZWF0ZVJvdXRlckhhbmRsZXJ9IGZyb20gXCJAb2hvYXJlYXUvbGFtYmRhLXV0aWxzXCI7XG5pbXBvcnQgaW1hZ2VtYW4sIHtpbWFnZW1hbl9hcmdzfSBmcm9tICdAb2hvYXJlYXUvaW1hZ2VtYW4nO1xuaW1wb3J0IHBhcnNlRXZlbnQgZnJvbSBcIi4vdXRpbHMvcGFyc2VFdmVudFwiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcblxuICAgIC8vIHRoaXMgbGFtYmRhIGhhbmRsZXIgd2lsbCBoYW5kbGUgY29tcGxldGVseSB0aGUgaHR0cCBldmVudCBjb21pbmcgZnJvbSBhbiBBUEkgR2F0ZXdheSBhcGlcbiAgICAvLyBmZWF0dXJlcyBhcmUgKG5vdCBleGhhdXN0aXZlKTogcmVzaXppbmcgb2Ygc291cmNlIGltYWdlcywgZmxpcHBpbmcsIGNvbnZlcnNpb24gKHN2ZyA9PiBwbmcsIC4uLilcblxuICAgIHJldHVybiBjcmVhdGVSb3V0ZXJIYW5kbGVyKFxuXG4gICAgICAgIC8vIHRoaXMgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgb25seSBpZiB0aGUgcmVxdWVzdGVkIHJlc291cmNlIGlzIG5vdCBmYXZpY29uL3JvYm90cy50eHQvLi4uXG4gICAgICAgIC8vIHRoaXMgaXMgdGhlIGhlYXJ0IG9mIHRoZSBtaWNyb3NlcnZpY2UsIHRoZSBjdXN0b20gcGFydC5cblxuICAgICAgICBhc3luYyBmdW5jdGlvbiAoe2NvbmZpZywgcmVzcG9uc2VzfSwgZXZlbnQsIGNvbnRleHQpIHtcblxuICAgICAgICAgICAgLy8gdGhlIGBldmVudGAgY29udGFpbnMgdGhlIEFQSSBHYXRld2F5IHJhdyBldmVudFxuICAgICAgICAgICAgLy8gdGhlIGBjb25maWdgIG9iamVjdCBpcyBjb21pbmcgZnJvbSB0aGUgY29uZmlndXJhdGlvbiBmaWxlIChjb25maWcuanMpXG4gICAgICAgICAgICAvLyB0aGUgYHJlc3BvbnNlc2AgdmFyaWFibGUgY29udGFpbnMgaGVscGVycyBmb3Igc2VuZGluZyBjb21tb24gcmVzcG9uc2VzIChyZWRpcmVjdCwgbm90Zm91bmQsIC4uLilcbiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gcGFyc2UgdGhpcyBldmVudCB0byBidWlsZCB0aGUgb3JkZXIgd2Ugd2FudCB0byBzZW5kIHRvIGltYWdlbWFuLlxuICAgICAgICAgICAgLy8gb3B0aW9ucyBhcmUgdXNlZCBmb3IgY29udGVudFR5cGUgYW5kIGh0dHAgb3B0aW9ucyBmb3IgdGhlIHJlc3BvbnNlLlxuXG4gICAgICAgICAgICBjb25zdCB7b3B0aW9ucywgLi4ub3JkZXJ9ID0gYXdhaXQgcGFyc2VFdmVudChldmVudCwgY29udGV4dCwgY29uZmlnKTtcblxuICAgICAgICAgICAgLy8gdGhlIG9yZGVyIGlzIHNoYXBlZCwgd2Ugbm93IGNhbGwgdGhlIGltYWdlbWFuIHByb2Nlc3NvciBhbmQgcmV0dXJuXG4gICAgICAgICAgICAvLyB0aGUgY29udGVudCBvZiB0aGUgcmVzdWx0aW5nIGJ1ZmZlciBmcm9tIGltYWdlbWFuXG5cbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGltYWdlbWFuKG9yZGVyIGFzIGltYWdlbWFuX2FyZ3MpO1xuXG4gICAgICAgICAgICAvLyB0aGUgZmluYWwgcmVzcG9uc2Ugd2lsbCBiZSBjb21wYXRpYmxlIHdpdGggQVBJIEdhdGV3YXkgKHN0YXR1c0NvZGUsIGJvZHksIC4uLilcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlcy5idWZmZXIoe2J1ZmZlciwgLi4ub3B0aW9uc30pO1xuXG4gICAgICAgIH1cbiAgICApO1xuXG59Il19