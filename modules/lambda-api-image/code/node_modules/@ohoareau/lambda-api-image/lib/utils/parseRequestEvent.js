"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function parseRequestEvent(event) {
    var _a, _b, _c, _d;
    const uri = ((_b = (_a = event === null || event === void 0 ? void 0 : event.requestContext) === null || _a === void 0 ? void 0 : _a.http) === null || _b === void 0 ? void 0 : _b.path) || '/';
    const method = (((_d = (_c = event === null || event === void 0 ? void 0 : event.requestContext) === null || _c === void 0 ? void 0 : _c.http) === null || _d === void 0 ? void 0 : _d.method) || 'GET').toUpperCase();
    const params = ((event === null || event === void 0 ? void 0 : event.queryStringParameters) || {});
    const headers = ((event === null || event === void 0 ? void 0 : event.headers) || {});
    return {
        uri,
        method,
        params: Object.entries(params).reduce((acc, [k, v]) => {
            if (!v)
                return acc;
            if (-1 === v.indexOf(',')) {
                acc[k] = v;
                return acc;
            }
            acc[k] = v.split(/,/g);
            return acc;
        }, {}),
        headers: Object.entries(headers).reduce((acc, [k, v]) => {
            if (!v)
                return acc;
            if (-1 === v.indexOf(',')) {
                acc[k] = v;
                return acc;
            }
            acc[k] = v.split(/,/g);
            return acc;
        }, {}),
    };
}
exports.parseRequestEvent = parseRequestEvent;
exports.default = parseRequestEvent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2VSZXF1ZXN0RXZlbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvcGFyc2VSZXF1ZXN0RXZlbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFFQSxTQUFnQixpQkFBaUIsQ0FBQyxLQUFVOztJQUV4QyxNQUFNLEdBQUcsR0FBRyxhQUFBLEtBQUssYUFBTCxLQUFLLHVCQUFMLEtBQUssQ0FBRSxjQUFjLDBDQUFFLElBQUksMENBQUUsSUFBSSxLQUFJLEdBQUcsQ0FBQztJQUNyRCxNQUFNLE1BQU0sR0FBRyxDQUFDLGFBQUEsS0FBSyxhQUFMLEtBQUssdUJBQUwsS0FBSyxDQUFFLGNBQWMsMENBQUUsSUFBSSwwQ0FBRSxNQUFNLEtBQUksS0FBSyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDNUUsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFBLEtBQUssYUFBTCxLQUFLLHVCQUFMLEtBQUssQ0FBRSxxQkFBcUIsS0FBSSxFQUFFLENBQUMsQ0FBQztJQUNwRCxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUEsS0FBSyxhQUFMLEtBQUssdUJBQUwsS0FBSyxDQUFFLE9BQU8sS0FBSSxFQUFFLENBQUMsQ0FBQztJQUV2QyxPQUFPO1FBQ0gsR0FBRztRQUNILE1BQU07UUFDTixNQUFNLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtZQUNsRCxJQUFJLENBQUMsQ0FBQztnQkFBRSxPQUFPLEdBQUcsQ0FBQztZQUNuQixJQUFJLENBQUMsQ0FBQyxLQUFNLENBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ25DLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ1gsT0FBTyxHQUFHLENBQUM7YUFDZDtZQUNELEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBSSxDQUFZLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ25DLE9BQU8sR0FBRyxDQUFDO1FBQ2YsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNOLE9BQU8sRUFBRSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFO1lBQ3BELElBQUksQ0FBQyxDQUFDO2dCQUFFLE9BQU8sR0FBRyxDQUFDO1lBQ25CLElBQUksQ0FBQyxDQUFDLEtBQU0sQ0FBWSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtnQkFDbkMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDWCxPQUFPLEdBQUcsQ0FBQzthQUNkO1lBQ0QsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFJLENBQVksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbkMsT0FBTyxHQUFHLENBQUM7UUFDZixDQUFDLEVBQUUsRUFBRSxDQUFDO0tBQ1QsQ0FBQztBQUVOLENBQUM7QUE5QkQsOENBOEJDO0FBRUQsa0JBQWUsaUJBQWlCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3JlcXVlc3R9IGZyb20gXCIuLi90eXBlc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VSZXF1ZXN0RXZlbnQoZXZlbnQ6IGFueSk6IHJlcXVlc3Qge1xuXG4gICAgY29uc3QgdXJpID0gZXZlbnQ/LnJlcXVlc3RDb250ZXh0Py5odHRwPy5wYXRoIHx8ICcvJztcbiAgICBjb25zdCBtZXRob2QgPSAoZXZlbnQ/LnJlcXVlc3RDb250ZXh0Py5odHRwPy5tZXRob2QgfHwgJ0dFVCcpLnRvVXBwZXJDYXNlKCk7XG4gICAgY29uc3QgcGFyYW1zID0gKGV2ZW50Py5xdWVyeVN0cmluZ1BhcmFtZXRlcnMgfHwge30pO1xuICAgIGNvbnN0IGhlYWRlcnMgPSAoZXZlbnQ/LmhlYWRlcnMgfHwge30pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdXJpLFxuICAgICAgICBtZXRob2QsXG4gICAgICAgIHBhcmFtczogT2JqZWN0LmVudHJpZXMocGFyYW1zKS5yZWR1Y2UoKGFjYywgW2ssIHZdKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXYpIHJldHVybiBhY2M7XG4gICAgICAgICAgICBpZiAoLTEgPT09ICh2IGFzIHN0cmluZykuaW5kZXhPZignLCcpKSB7XG4gICAgICAgICAgICAgICAgYWNjW2tdID0gdjtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWNjW2tdID0gKHYgYXMgc3RyaW5nKS5zcGxpdCgvLC9nKTtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIHt9KSxcbiAgICAgICAgaGVhZGVyczogT2JqZWN0LmVudHJpZXMoaGVhZGVycykucmVkdWNlKChhY2MsIFtrLCB2XSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF2KSByZXR1cm4gYWNjO1xuICAgICAgICAgICAgaWYgKC0xID09PSAodiBhcyBzdHJpbmcpLmluZGV4T2YoJywnKSkge1xuICAgICAgICAgICAgICAgIGFjY1trXSA9IHY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFjY1trXSA9ICh2IGFzIHN0cmluZykuc3BsaXQoLywvZyk7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCB7fSksXG4gICAgfTtcblxufVxuXG5leHBvcnQgZGVmYXVsdCBwYXJzZVJlcXVlc3RFdmVudCJdfQ==