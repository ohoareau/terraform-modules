"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
async function preset(order, request, config) {
    var _a;
    if (!((_a = request.qsParams) === null || _a === void 0 ? void 0 : _a.preset))
        return;
    const presets = Array.isArray(request.qsParams.preset) ? request.qsParams.preset : [request.qsParams.preset];
    return presets.reduce((acc, p) => {
        let preset = (config.presets || {})[p] || {};
        ('function' === typeof preset) && (preset = preset(request) || {});
        return {
            ...acc,
            ...preset,
            operations: [
                ...(acc.operations || []),
                ...(preset.operations || []),
            ]
        };
    }, order);
}
exports.preset = preset;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJlc2V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL21vZGlmaWVycy9wcmVzZXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFHTyxLQUFLLFVBQVUsTUFBTSxDQUFDLEtBQVksRUFBRSxPQUFxQixFQUFFLE1BQVc7O0lBQ3pFLElBQUksUUFBQyxPQUFPLENBQUMsUUFBUSwwQ0FBRSxNQUFNLENBQUE7UUFBRSxPQUFPO0lBQ3RDLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNoSCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDN0IsSUFBSSxNQUFNLEdBQUcsQ0FBQyxNQUFNLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM3QyxDQUFDLFVBQVUsS0FBSyxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUNuRSxPQUFPO1lBQ0gsR0FBRyxHQUFHO1lBQ04sR0FBRyxNQUFNO1lBQ1QsVUFBVSxFQUFFO2dCQUNSLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBVSxJQUFJLEVBQUUsQ0FBQztnQkFDekIsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLElBQUksRUFBRSxDQUFDO2FBQy9CO1NBQ0osQ0FBQTtJQUNMLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNkLENBQUM7QUFmRCx3QkFlQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7b3JkZXJ9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7aHR0cF9yZXF1ZXN0fSBmcm9tICdAb2hvYXJlYXUvbGFtYmRhLXV0aWxzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByZXNldChvcmRlcjogb3JkZXIsIHJlcXVlc3Q6IGh0dHBfcmVxdWVzdCwgY29uZmlnOiBhbnkpIHtcbiAgICBpZiAoIXJlcXVlc3QucXNQYXJhbXM/LnByZXNldCkgcmV0dXJuO1xuICAgIGNvbnN0IHByZXNldHMgPSBBcnJheS5pc0FycmF5KHJlcXVlc3QucXNQYXJhbXMhLnByZXNldCkgPyByZXF1ZXN0LnFzUGFyYW1zIS5wcmVzZXQgOiBbcmVxdWVzdC5xc1BhcmFtcyEucHJlc2V0XTtcbiAgICByZXR1cm4gcHJlc2V0cy5yZWR1Y2UoKGFjYywgcCkgPT4ge1xuICAgICAgICBsZXQgcHJlc2V0ID0gKGNvbmZpZy5wcmVzZXRzIHx8IHt9KVtwXSB8fCB7fTtcbiAgICAgICAgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBwcmVzZXQpICYmIChwcmVzZXQgPSBwcmVzZXQocmVxdWVzdCkgfHwge30pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uYWNjLFxuICAgICAgICAgICAgLi4ucHJlc2V0LFxuICAgICAgICAgICAgb3BlcmF0aW9uczogW1xuICAgICAgICAgICAgICAgIC4uLihhY2Mub3BlcmF0aW9ucyB8fCBbXSksXG4gICAgICAgICAgICAgICAgLi4uKHByZXNldC5vcGVyYXRpb25zIHx8IFtdKSxcbiAgICAgICAgICAgIF1cbiAgICAgICAgfVxuICAgIH0sIG9yZGVyKTtcbn0iXX0=