"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const lambda_utils_1 = require("@ohoareau/lambda-utils");
async function s3(ctx, config) {
    const { bucket, key } = ctx.query;
    const bucketName = (config.buckets || {})[bucket];
    if (!bucketName || !key)
        throw new lambda_utils_1.ResourceNotFoundError(ctx.request);
    const options = {};
    const contentType = lambda_utils_1.detectContentTypeFromFileName(key);
    contentType && (options.contentType = contentType);
    return {
        input: `s3://${bucketName}/${key}`,
        options,
    };
}
exports.s3 = s3;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiczMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc291cmNlcy9zMy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlEQUFpRztBQUUxRixLQUFLLFVBQVUsRUFBRSxDQUFDLEdBQVEsRUFBRSxNQUFXO0lBQzFDLE1BQU0sRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFDLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQztJQUNoQyxNQUFNLFVBQVUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbEQsSUFBSSxDQUFDLFVBQVUsSUFBSSxDQUFDLEdBQUc7UUFBRSxNQUFNLElBQUksb0NBQXFCLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3RFLE1BQU0sT0FBTyxHQUFRLEVBQUUsQ0FBQztJQUN4QixNQUFNLFdBQVcsR0FBRyw0Q0FBNkIsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN2RCxXQUFXLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyxDQUFDO0lBQ25ELE9BQU87UUFDSCxLQUFLLEVBQUUsUUFBUSxVQUFVLElBQUksR0FBRyxFQUFFO1FBQ2xDLE9BQU87S0FDVixDQUFDO0FBQ04sQ0FBQztBQVhELGdCQVdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtjdHgsIGRldGVjdENvbnRlbnRUeXBlRnJvbUZpbGVOYW1lLCBSZXNvdXJjZU5vdEZvdW5kRXJyb3J9IGZyb20gJ0BvaG9hcmVhdS9sYW1iZGEtdXRpbHMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gczMoY3R4OiBjdHgsIGNvbmZpZzogYW55KSB7XG4gICAgY29uc3Qge2J1Y2tldCwga2V5fSA9IGN0eC5xdWVyeTtcbiAgICBjb25zdCBidWNrZXROYW1lID0gKGNvbmZpZy5idWNrZXRzIHx8IHt9KVtidWNrZXRdO1xuICAgIGlmICghYnVja2V0TmFtZSB8fCAha2V5KSB0aHJvdyBuZXcgUmVzb3VyY2VOb3RGb3VuZEVycm9yKGN0eC5yZXF1ZXN0KTtcbiAgICBjb25zdCBvcHRpb25zOiBhbnkgPSB7fTtcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IGRldGVjdENvbnRlbnRUeXBlRnJvbUZpbGVOYW1lKGtleSk7XG4gICAgY29udGVudFR5cGUgJiYgKG9wdGlvbnMuY29udGVudFR5cGUgPSBjb250ZW50VHlwZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5wdXQ6IGBzMzovLyR7YnVja2V0TmFtZX0vJHtrZXl9YCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICB9O1xufSJdfQ==