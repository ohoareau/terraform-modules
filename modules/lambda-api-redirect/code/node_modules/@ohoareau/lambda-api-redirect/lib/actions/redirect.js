"use strict";
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
const availableSources = __importStar(require("../sources"));
async function redirect(ctx) {
    const sources = { ...availableSources, ...(ctx.config.sources || {}) };
    const source = sources[ctx.query.source || 'default'];
    if (!source)
        return ctx.helpers.httpNotFound();
    const sourced = (await source(ctx)) || {};
    if (!sourced || !sourced.location)
        return ctx.helpers.httpNotFound();
    return ctx.helpers.redirect(sourced);
}
exports.redirect = redirect;
exports.default = redirect;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVkaXJlY3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYWN0aW9ucy9yZWRpcmVjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDQSw2REFBK0M7QUFFeEMsS0FBSyxVQUFVLFFBQVEsQ0FBQyxHQUFRO0lBQ25DLE1BQU0sT0FBTyxHQUFHLEVBQUMsR0FBRyxnQkFBZ0IsRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLEVBQUMsQ0FBQztJQUNyRSxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLElBQUksU0FBUyxDQUFDLENBQUM7SUFDdEQsSUFBSSxDQUFDLE1BQU07UUFBRSxPQUFPLEdBQUcsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDL0MsTUFBTSxPQUFPLEdBQUcsQ0FBQyxNQUFNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUMxQyxJQUFJLENBQUMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVE7UUFBRSxPQUFPLEdBQUcsQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUM7SUFDckUsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN6QyxDQUFDO0FBUEQsNEJBT0M7QUFFRCxrQkFBZSxRQUFRLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2N0eCwgaHR0cF9yZXNwb25zZX0gZnJvbSBcIkBvaG9hcmVhdS9sYW1iZGEtdXRpbHNcIjtcbmltcG9ydCAqIGFzIGF2YWlsYWJsZVNvdXJjZXMgZnJvbSBcIi4uL3NvdXJjZXNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZGlyZWN0KGN0eDogY3R4KTogUHJvbWlzZTxodHRwX3Jlc3BvbnNlPiB7XG4gICAgY29uc3Qgc291cmNlcyA9IHsuLi5hdmFpbGFibGVTb3VyY2VzLCAuLi4oY3R4LmNvbmZpZy5zb3VyY2VzIHx8IHt9KX07XG4gICAgY29uc3Qgc291cmNlID0gc291cmNlc1tjdHgucXVlcnkuc291cmNlIHx8ICdkZWZhdWx0J107XG4gICAgaWYgKCFzb3VyY2UpIHJldHVybiBjdHguaGVscGVycy5odHRwTm90Rm91bmQoKTtcbiAgICBjb25zdCBzb3VyY2VkID0gKGF3YWl0IHNvdXJjZShjdHgpKSB8fCB7fTtcbiAgICBpZiAoIXNvdXJjZWQgfHwgIXNvdXJjZWQubG9jYXRpb24pIHJldHVybiBjdHguaGVscGVycy5odHRwTm90Rm91bmQoKTtcbiAgICByZXR1cm4gY3R4LmhlbHBlcnMucmVkaXJlY3Qoc291cmNlZCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlZGlyZWN0Il19